(function(){var d=Handlebars.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(d,c,e,l,h){var f,a;return'\x3cdiv class\x3d"cols-row" \x3e\n    \x3cdiv class\x3d""\x3e\n        \x3cbutton type\x3d"button" data-control\x3d"remove" data-target-id\x3d"" class\x3d"btn-primary btn-close air-attach-close" id\x3d"air-attach-close-btn"\x3e\n          \x3cspan class\x3d"icon icon-close" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n          \x3cspan class\x3d"alt"\x3eClose\x3c/span\x3e\n        \x3c/button\x3e\n        \x3ca href\x3d"'+d.escapeExpression((a=null!=(a=e.hotelSearchUrl||(null!=c?c.hotelSearchUrl:c))?a:e.helperMissing,"function"===typeof a?a.call(null!=c?c:{},{name:"hotelSearchUrl",hash:{},data:h}):a))+'" class\x3d"cf" data-onclick\x3d"xp.nav.trackAnalytics(this,\'a\',\'MIP.HOT.EXPEDIA.STOREFRONT\')"\x3e\n            \x3cspan class\x3d"air-attach-message"\x3e\n                \x3cspan class\x3d"icon icon-flights" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n                \x3cspan class\x3d"icon"\x3e+\x3c/span\x3e\n                \x3cspan class\x3d"icon icon-hotels" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n                '+(null!=(f=(a=null!=(a=e.discountMessage||(null!=c?c.discountMessage:c))?a:e.helperMissing,"function"===typeof a?a.call(null!=c?c:{},{name:"discountMessage",hash:{},data:h}):a))?f:"")+'\n            \x3c/span\x3e\n            \x3cspan class\x3d"offer-countdown"\x3e\n                \x3cspan class\x3d"icon icon-time" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n                \x3cspan class\x3d"offer-countdown-timer"\x3e\x3c/span\x3e\n            \x3c/span\x3e\n        \x3c/a\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n'},useData:!0});Handlebars.templates=Handlebars.templates||{};Handlebars.templates.airAttach=d;Handlebars.partials=Handlebars.partials||{};Handlebars.partials.airAttach=d})();define("airAttach-loc",function(){return{hotelDiscountMessage:'Your flight purchase qualifies you for up to {{g_msg_discountValue}}% off select \x3cu\x3ehotels\x3c/u\x3e for your \x3cb class\x3d"airattach-trip-cityname"\x3e{{cityname}}\x3c/b\x3e trip',mipqDiscountMessage:'Your recent booking qualifies you for up to 40% off select hotels for your \x3cb class\x3d"airattach-trip-cityname"\x3e{{cityname}}\x3c/b\x3e trip',offerExpireDays:"Offer expires in X days",offerExpireHours:'Offer expires in \x3cspan class\x3d"offer-countdown-timer"\x3ehh:mm:ss\x3c/span\x3e'}});var dependencies="handlebars hotelSearchUrl airAttach-loc uitk uitk_localized_dateApi bannerConsolidation sfAbTest".split(" ");define("airAttachBanner",dependencies,function(d,f,c,e,l,h,n){var a=a||{},k,g=$(".air-attach-container");a.init=function(){k=h.getSelectedBannerStatus();require(["storefrontPageModel"],function(b){b=JSON.parse(b.watsonDataJson).multiItemPriceQualification;if("object"===typeof b){var c="January February March April May June July August September October November December".split(" "),m=new Date(1E3*b.startDate.seconds),d=new Date(1E3*b.endDate.seconds);a.timer=((new Date(1E3*b.expirationDate.seconds)).getTime()-(new Date).getTime())/1E3;a.startDate=e.utils.createLocalizedDate(c[m.getMonth()]+" "+m.getDate()+" "+m.getFullYear(),e.locale).shortDate();a.endDate=e.utils.createLocalizedDate(c[d.getMonth()]+" "+d.getDate()+" "+d.getFullYear(),e.locale).shortDate();a.enableOfferWindowTillTravel=!1;a.destinationName=b.destinationName;a.destinationID=b.destinationID;a.showMipqBanner()}else $.ajax({dataType:"json",url:"/api/airattach/qualification",success:a.callback,complete:function(a,b){var c={status:b};"success"===b&&"object"===typeof a&&"string"===typeof a.responseText&&0<a.responseText.length&&-1<a.responseText.indexOf("tripID")&&(c.hasTripInfo=!0);window.dctk&&dctk.enabled&&dctk.logging&&dctk.logging.logError?dctk.logging.logMessage("sf-web:air-attach",c):require("dctk/clientLogging",function(a){a.logMessage("sf-web:air-attach",c)})},cache:!1,timeout:5E3})})};a.callback=function(b){if(b&&b.qualificationWindows&&0<b.qualificationWindows.length){b=b.qualificationWindows[0];var c=b.tripInfo.finalDestinationAirportCode;a.setAirattachData(b);a.setSearchUrlAndCityName(c);if(window.dctk&&window.dctk.onReady)dctk.onReady(function(){dctk.trackAction("MIP.Hot.Shown.Storefront")});else require("dctk/dctk",function(a){a.onReady(function(){a.trackAction("MIP.Hot.Shown.Storefront")})});a.mipqBannerTracking()}};a.testBanner=function(){k=!0;a.renderBanner({hotelSearchUrl:"http://www.expedia.com",discountMessage:"Test banner for AirAtach"})};a.setAirattachData=function(b){a.timer=b.timeLeftForExpirationInMilliSecs/1E3;a.startDate=e.utils.createLocalizedDate(b.startDate,e.locale).shortDate();a.endDate=e.utils.createLocalizedDate(b.endDate,e.locale).shortDate();a.origin=b.tripInfo.originAirportCode;a.tripType=b.tripInfo.tripType;a.enableOfferWindowTillTravel=b.enableOfferWindowTillTravel};a.renderBanner=function(b){if("show"===k||!0===k){var c=d.partials.airAttach;b=c(b);g.html(b);a.renderCountdown();b=g.height();g.css("height",0).animate({height:b,opacity:1},1500,function(){$(this).css("height","auto")});$(".air-attach-close").on("click",this.closeAirAttachBanner);a.mipqBannerTracking();a.bindEvents()}};a.renderCountdown=function(){var b,e,d,f=$(".offer-countdown-timer"),h=$(".offer-countdown");var g=a.enableOfferWindowTillTravel?Math.ceil(a.timer/86400):Math.floor(a.timer/86400);if(3<=g)g=c.offerExpireDays.replace("X",g),f.html(g),h.addClass("timer-ready");else{var k=c.offerExpireHours;h.addClass("timer-ready");var l=setInterval(function(){var c=a.timer--; -1===c?(h.removeClass("timer-ready"),clearInterval(l)):(b=parseInt(c/3600,10),c%=3600,e=parseInt(c/60,10),d=parseInt(c%60,10),10>b&&(b="0"+b),10>e&&(e="0"+e),10>d&&(d="0"+d),c=k.replace("hh",b).replace("mm",e).replace("ss\x3c",d+"\x3c"),f.html(c))},1E3)}};a.showMipqBanner=function(){a.hotelSearchUrl=f({regionId:a.destinationID,rooms:[{adults:1}],startDate:a.startDate,endDate:a.endDate,isHashlessURLneeded:!0});var b={hotelSearchUrl:a.hotelSearchUrl,discountMessage:c.mipqDiscountMessage.replace("{{cityname}}",a.destinationName)};a.renderBanner(b)};a.setSearchUrlAndCityName=function(b){a.getDataFromAirportTla(b,function(b){a.regionId=b.sr[0].hierarchyInfo.airport.multicity;a.cityname=b.sr[0].regionNames.shortName.split(",")[0].replace(/(<([^>]+)>)/ig,"");a.hotelSearchUrl=f({regionId:a.regionId,rooms:[{adults:1}],startDate:"ROUND_TRIP"===a.tripType?a.startDate:"",endDate:"ROUND_TRIP"===a.tripType?a.endDate:"",isHashlessURLneeded:!0});var e={discountMessage:c.hotelDiscountMessage.replace("{{g_msg_discountValue}}",window.airAttachVal).replace("{{cityname}}",a.cityname),hotelSearchUrl:a.hotelSearchUrl};"1"!==siteid&&"14"!==siteid||n.get(14553,!0,function(a){1===a.value&&(g=$("#hotmip-container"))});require(["airAttachBanner"],function(a){a.renderBanner(e)})})};a.getDataFromAirportTla=function(a,c){$.ajax({dataType:"jsonp",url:"https://suggest.expedia.com/api/v4/typeahead/"+a+"?format\x3djsonp\x26client\x3dHomepage\x26regiontype\x3d1\x26maxresults\x3d1\x26lob\x3dFLIGHTS\x26locale\x3d"+locale,success:c,timeout:5E3})};a.mipqBannerTracking=function(){require("dctk/dctk",function(a){a.onReady(function(){a.trackEvent({trackEvents:"event132,event152"})})})};a.bindEvents=function(){$("#air-attach-close-btn").on("click",function(){a.setCloseCookie()})};a.closeAirAttachBanner=function(){h.hasStarted&&h.setNextBanner();g.css("opacity",1).animate({opacity:0},{duration:600,complete:function(){g.addClass("hidden")}})};a.isCloseCookieSet=function(){return 0<=document.cookie.indexOf("MIPBClose")};a.setCloseCookie=function(){var a=new Date;a.setTime(a.getTime()+864E5);document.cookie="MIPBClose\x3dyes; expires\x3d"+a.toGMTString()};return a});require(["airAttachBanner"],function(d){if(d.isCloseCookieSet()){var f={message:"Close cookie is set"};window.dctk&&dctk.enabled&&dctk.logging&&dctk.logging.logError?dctk.logging.logMessage("sf-web:air-attach",f):require("dctk/clientLogging",function(c){c.logMessage("sf-web:air-attach",f)})}else d.init()});
require(["jquery","uitk"],function(d,f){function c(){d(document).on(f.clickEvent,".air-attach-container",function(){if(window.dctk&&window.dctk.onReady)dctk.onReady(function(){dctk.trackAction("MIP.Hot.Click.Storefront")});else require("dctk/dctk",function(c){c.onReady(function(){c.trackAction("MIP.Hot.Click.Storefront")})})})}d(function(){c()})});var test={};
//# sourceMappingURL=airAttachBanner-1-en_US.js.map