define(["cQueryPro","CIDate","cDatePicker","cAddress","modHotelsSearchBoxI18n"],function(t,e,i,o,a){var s=a.data.Category;window.isGoogle=!1,String.prototype.trim||(String.prototype.trim=function(){for(var t=this,t=t.replace(/^\s+/,""),e=t.length-1;e>=0;e--)if(/\S/.test(t.charAt(e))){t=t.substring(0,e+1);break}return t}),window.htmlencode=function(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML},window.filterCities=function(e){return function(i){var o={key:unescape(e),data:[]};if(i&&i.result&&i.result.length>0)for(var a=0;a<i.result.length;a++){var s=i.result[a],n=s.type;if(""!==s&&s.word){var r="";"City"!=n&&"Intlcity"!=n&&"IntlDistrict"!=n&&"District"!=n&&(r=s.word);var d=l.GetDisplayString(s,!0);if(""!=d){var c=l.SetDisplayColorGroup(s.tokens,d),h=l.GetTagIcon(n);"City"===n||"Intlcity"===n||"IntlDistrict"===n||"District"===n?o.data.push(encodeURIComponent(c)+"|"+encodeURIComponent(d)+"|"+s.cityid+"|"+s.id+"|"+s.type+"|||"+encodeURIComponent(h)+"||"+encodeURIComponent(r)+"|"+a+"|"+s.timeoffset+"||"+s.countryid):o.data.push(encodeURIComponent(c)+"|"+encodeURIComponent(d)+"|"+s.cityid+"|"+s.id+"|"+s.type+"|"+s.lat+"|"+s.lon+"|"+encodeURIComponent(h)+"|"+encodeURIComponent(s.word)+"|"+encodeURIComponent(r)+"|"+a+"|"+s.timeoffset+"||"+s.countryid)}}}o.data.length>0?o.data="@"+o.data.join("@")+"@":o.data="",window.isGoogle=!1,t.jsonpResponse=o}},window.filterGoogleCities=function(e){return function(i){var o={key:unescape(e),data:[]};i=l.DataFormat(i);for(var a=0;a<i.length;a++){var s=i[a].split("|"),n=s[0],r=s[1],d=-1;if(s.length>2&&(d=s[2]),""!=n&&""!=r){var c=l.SetDisplayColor(l.filterSpicalCharForRegx(o.key),n);o.data.push(c+"|"+n+"|||||||||"+d+"||"+r+"|1")}}o.data.length>0?o.data="@"+o.data.join("@")+"@":o.data="",window.isGoogle=!0,t.jsonpResponse=o}};var l={Language:__SITE_CONFIG__.page.language.toLocaleLowerCase(),IsShowLandmark:!0,deleteDuplicateValue:function(e,i){var o;return o=[e.word],""!=t.trim(e.cityname)&&t.inArray(e.cityname,o)<0&&o.push(e.cityname),""!=t.trim(e.parentname)&&t.inArray(e.parentname,o)<0&&o.push(e.parentname),""!=t.trim(e.provincename)&&t.inArray(e.provincename,o)<0&&o.push(e.provincename),!i&&""!=t.trim(e.countryname)&&t.inArray(e.countryname,o)<0&&o.push(e.countryname),o},GetDisplayString:function(t,e){var i,o=new Array;e&&"1"!=t.countryid&&"0"!=t.countryid&&""!=t.ename&&"en"!=this.Language&&(""===t.word?t.word+=t.ename:t.word+=t.ename&&t.word&&t.ename!==t.word&&t.word.indexOf(t.ename)==-1?" ("+t.ename+")":""),t.cityname=""===t.cityname?t.cityenname:t.cityname,t.provincename=""===t.provincename?t.provinceename:t.provincename,t.countryname=""===t.countryname?t.countryename:t.countryname;var a=["617","720","3844","3845","3846","3847","3848","3849","5152","5383","5589","6954","7203","7523","7524","7570","7613","7614","7662","7805","7808","7809","7810","7811"],s=["371396","43845","98402","371397","425097","428236","435933","476192","534259","699372","704560","705208","715910","773602","791589","802966","843544","939911","993889","997998","1055899","1212647","1213390","1371798","1390010","1430364","1454343","1478510","1674640","1685584","1734841","1743554","1757066","1779497","1817557","1836447","1836993","1911940","1924800","2041216","2080399","2096584","2159082","2277944","2279456","2540244","2541402","2586848","2605733","2606751","2650213","2883219","2885403","2890200","2919985","2987054","2987528","2988381","2999955","3033077","3109737","3292576","3441920","3447370","3451173"];switch(t.type){case"Hotel":i=s.indexOf(t.id)>=0?[]:l.deleteDuplicateValue(t,a.indexOf(t.cityid)>=0);break;default:i=l.deleteDuplicateValue(t,a.indexOf(t.cityid)>=0)}for(var n=0;n<i.length;n++){var r=i[n];r&&""!=r&&o.push(r)}return o.join(", ").replace(/\|/g,"")},GetTagIcon:function(t){var e="";switch(t){case"Markland":e=s.landmarks+"<i class='fi fi-landmark'></i></span>";break;case"Province":e=s.state+"<i class='fi fi-province'></i></span>";break;case"Intlcity":case"City":e=s.cities+"<i class='fi fi-city'></i></span>";break;case"Zone":e=s.commercialarea+"<i class='fi fi-shopping'></i></span>";break;case"Location":e=s.location+"<i class='fi fi-district'></i></span>";break;case"Airport":case"IntlPOIAirport":e=s.airports+"<i class='fi fi-flight'></i></span>";break;case"RailwayStation":e=s.stations+"<i class='fi fi-train'></i></span>";break;case"Hotel":e=s.hotels+"<i class='fi fi-hotel'></i></span>";break;case"Metro":e=s.metro+"<i class='fi fi-metro-line'></i></span>";break;case"MetroStation":e=s.metrostation+"<i class='fi fi-metro'></i></span>";break;case"CityHotelBrand":e=s.brand+"<i class='fi fi-brand'></i></span>";break;case"CityHotelGroup":e=s.group+"<i class='fi fi-group-company'></i></span>";break;case"District":case"IntlDistrict":e=s.areas+"<i class='fi fi-scenic-spot'></i></span>";break;default:e=""}return e},SetDisplayColor:function(t,e){var i=new RegExp(t,"i");return null!=e.match(i)&&e.match(i)[0].length>0?e.replace(i,"<strong>$&</strong>"):e},SetDisplayColorGroup:function(t,e){if(t&&t.length)for(var i=0;i<t.length;i++)e=l.SetDisplayColor(l.filterSpicalCharForRegx(t[i]),e);return e},filterSpicalCharForRegx:function(t){for(var e=["\\","^","$",".","*","+","=",":","|","/","(",")","[","]","{","}"],i=0;i<e.length;i++)t=t.replace(e[i],"\\"+e[i]);return t},DataFormat:function(t){var e=new Array;if(t.result.length>0)for(var i=t.result.split("@"),o=0;o<i.length;o++)e.push(i[o]);return e}},n={css:{form:"from",hotelsCity:"#hotelsCity",txtCheckInDisplay:"#txtCheckInDisplay",txtCheckIn:"#txtCheckIn",txtCheckOutDisplay:"#txtCheckOutDisplay",txtCheckOut:"#txtCheckOut",nightsTip:".mc-srh_ho__nights-txt",starPanel:".mc-srh_ho__star-rating",starItem:".mc-srh_ho__star-item",searchBtn:"#homesearch-btn",hotelsCityHid:"#cityId",optionIdHid:"#optionId",optionTypeHid:"#optionType",latHid:"#lat",lonHid:"#lon",displayValueHid:"#displayValue",markLandHid:"#markland",optionNameHid:"#optionName",googlePlaceIdHid:"#googlePlaceId",labelValueHid:"#label",utcDateNowHid:"#utcDateNow",timeOffsetHid:"#timeOffset",positionHid:"#position",countryIdHid:"#countryId",hr2:"#hr2",hr3:"#hr3",hr4:"#hr4",hr5:"#hr5",starChecked:"is-active"},hasTitle:!1,title:"",hotelKeywordUrl:'/hotels/tool/IbuKeyWordSearch?keyword=${encodeURIComponent(unescape(decodeURIComponent(key)))}&callback=filterCities("${encodeURIComponent(unescape(decodeURIComponent(key)))}")',storeSearchDataKey:"cm_ht_sb_data",localStoreKey:"htl_sh",template:{body:'<div class="mod-main-search-hotel m-ms-hotel fn-search-box u-clearfix">            <input type="hidden" id="cityId" name="cityId">            <input type="hidden" id="optionId" name="optionId">            <input type="hidden" id="optionType" name="optionType" value="Js_City">            <input type="hidden" id="lat" name="lat">            <input type="hidden" id="lon" name="lon">            <input type="hidden" id="displayValue" name="displayValue">            <input type="hidden" id="markland" name="markland">            <input type="hidden" id="optionName" name="optionName">            <input type="hidden" id="googlePlaceId" name="googlePlaceId">            <input type="hidden" id="label" name="label">            <input type="hidden" id="utcDateNow" name="utcDateNow" value="">            <input type="hidden" id="timeOffset" name="timeOffset" value="28800">            <input type="hidden" id="position" name="position" value="">            <input type="hidden" id="countryId" name="countryId" value="1" />             <div class="mc-srh_ho mc-srh_ho_${__SITE_CONFIG__.page.language.toLowerCase()} u-clearfix is-active">              <div class="mc-srh_ho__field  u-clearfix">                <div class="mc-srh_ho__field-group mc-srh_ho__group-dest">                  <div class="mc-srh_ho__item-con">                    <div class="mc-srh_ho__field-item">                      <label class="mc-srh_ho__field-block">                        <span class="mc-srh_ho__label-txt">${i18n.LabelText_StayingIn}</span>                        <span class="mc-srh_ho__input-con"><input class="mc-srh_ho__input" type="text" name="hotelsCity" id="hotelsCity" placeholder="${i18n.V2_Hotel_SearchBox_Input_Annotation}"></span>                        <input type="hidden" name="txtCheckIn" id="txtCheckIn">                      </label>                    </div>                  </div>                </div>                <div class="mc-srh_ho__field-group mc-srh_ho__group-date">                  <div class="mc-srh_ho__item-con mc-srh_ho__field-checkin">                    <div class="mc-srh_ho__field-item">                      <label class="mc-srh_ho__field-block">                        <span class="mc-srh_ho__label-txt">${i18n.LabelText_Hotel_SearchBox_CheckIn}</span>                        <span class="mc-srh_ho__input-con"><input class="mc-srh_ho__input" type="text" name="txtCheckInDisplay" id="txtCheckInDisplay" placeholder="${i18n.CheckTip_InputCheckIn}"></span>                        <input type="hidden" name="txtCheckOut" id="txtCheckOut">                      </label>                    </div>                  </div>                  <div class="mc-srh_ho__date-sp mc-srh_ho__date-sp">                    <div class="mc-srh_ho__nights">                      <span class="mc-srh_ho__nights-num"></span>                      <span class="mc-srh_ho__nights-txt">${i18n.Hotel_Book_YourBook_Nights_V2}</span>                    </div>                  </div>                  <div class="mc-srh_ho__item-con mc-srh_ho__field-checkout">                    <div class="mc-srh_ho__field-item">                      <label class="mc-srh_ho__field-block">                        <span class="mc-srh_ho__label-txt">${i18n.LabelText_Hotel_SearchBox_CheckOut}</span>                        <span class="mc-srh_ho__input-con"><input class="mc-srh_ho__input" type="text" name="txtCheckOutDisplay" id="txtCheckOutDisplay" placeholder="${i18n.CheckTip_InputCheckOut}"></span>                      </label>                    </div>                  </div>                </div>                <div class="mc-srh_ho__field-group mc-srh_ho__group-option" id="childage">                  <div class="mc-srh_ho__field-item mc-srh_ho__field-dropdown js-dropdown-con">                    <label class="mc-srh_ho__field-block js-dropdown-click">                      <span class="mc-srh_ho__label-txt" title="${i18n.AdultChildTittle}">${i18n.AdultChildTittle}</span>                      <span class="mc-srh_ho__input-con"><span class="mc-srh_ho__input-txt">1 ${i18n.Adult}, 0 ${i18n.Child}</span></span>                      <i class="fi fi-arrow-down"></i>                    </label>                    <div class="mc-srh_ho__dropdown mc-srh_ho__dropdown-option">                      <div class="mc-srh_ho__dropdown-cnt">                        <div class="mc-srh_ho__guest-record">                          <p class="mc-srh_ho__dropdown-tips mc-srh_ho__tips-number">${i18n.AdultChildTips}</p>                          <div class="o-counter">                            <div class="o-counter__item">                              <div class="o-counter__label-con">                                <span class="o-counter__label">${i18n.AdultDescription}</span>                              </div>                              <div class="o-counter__stepper" data-type="adult">                                <span class="o-counter__minus is-disabled"><i class="fi fi-minus"></i></span>                                <span class="o-counter__num" id="adultCount" data-min="1" data-max="8">1</span>                                <span class="o-counter__plus"><i class="fi fi-plus"></i></span>                              </div>                            </div>                            <div class="o-counter__item">                              <div class="o-counter__label-con">                                <span class="o-counter__label">${i18n.ChildDescription}</span>                              </div>                              <div class="o-counter__stepper" data-type="child">                                <span class="o-counter__minus"><i class="fi fi-minus"></i></span>                                <span class="o-counter__num" id="childrenCount" data-min="0" data-max="3">0</span>                                <span class="o-counter__plus"><i class="fi fi-plus"></i></span>                              </div>                            </div>                          </div>                          <div class="mc-srh_ho__child-age">                            <span class="mc-srh_ho__child-age-tit" style="display:none;">${i18n.ChildAge}</span>                            <div class="mc-srh_ho__child-age-cnt u-clearfix"></div>                          </div>                        </div>                      </div>                      <div class="mc-srh_ho__close-con">                        <span class="mc-srh_ho__close-btn"><i class="fi fi-close"></i></span>                      </div>                    </div>                  </div>                </div>              </div>              <div class="mc-srh_ho__more-field u-clearfix">                <div class="mc-srh_ho__more-field-item mc-srh_ho__field-purpose">                  <span class="mc-srh_ho__label-txt">${i18n.TravelPurpose}</span>                  <div class="mc-srh_ho__travel-purpose">                    <label class="o-radiobox-c js-radiobox" data-purpose="1">                      <span class="o-radiobox-c__box"><i class="o-radiobox-c__box-dot"></i></span>                      <input class="o-radiobox-c__hide-box" type="radio" value="" name="radio-3" checked="">                      <span class="o-radiobox-c__label">${i18n.TravelPurpose_Business}</span>                    </label>                    <label class="o-radiobox-c js-radiobox" data-purpose="2">                      <span class="o-radiobox-c__box"><i class="o-radiobox-c__box-dot"></i></span>                      <input class="o-radiobox-c__hide-box" type="radio" value="" name="radio-3">                      <span class="o-radiobox-c__label">${i18n.TravelPurpose_Leisure}</span>                    </label>                  </div>                </div>                <div class="mc-srh_ho__more-field-item mc-srh_ho__field-star">                  <span class="mc-srh_ho__label-txt">${i18n.Hotel_Star_Rating_Optional_V2}</span>                  <div class="mc-srh_ho__star-rating">                    <span class="mc-srh_ho__star-item" value="1,2" index="0"><span class="mc-srh_ho__star-num">≤ 2</span><i class="fi fi-hotel-star-o"></i></span>                    <span class="mc-srh_ho__star-item" value="3" index="1"><span class="mc-srh_ho__star-num">3</span><i class="fi fi-hotel-star-o"></i></span>                    <span class="mc-srh_ho__star-item" value="4" index="2"><span class="mc-srh_ho__star-num">4</span><i class="fi fi-hotel-star-o"></i></span>                    <span class="mc-srh_ho__star-item" value="5" index="3"><span class="mc-srh_ho__star-num">5</span><i class="fi fi-hotel-star-o"></i></span>                  </div>                </div>              </div>              <div class="mc-srh_ho__action">              <button id="homesearch-btn" class="mc-srh_ho__btn-search "><span class="mc-srh_ho__btn-search-txt">${i18n.ButtonText_Hotel_Search}</span></button>              <button id="homesearch-btn-loading" class="mc-srh_ho__btn-search is-loading" style="display: none;"><span class="mc-loading-24-white"></span><span class="mc-srh_ho__btn-search-txt">${i18n.ButtonText_Hotel_Searching}</span></button>         </div></div>',suggestion:'<div id="ctripDestinaSelect">                <div class="m-droplist drop-top-city-picker hover-layout">                <p class="hd-tip">{{tmpl message.typeORSelect}}</p>\t               <h2 class="mod-tit">{{tmpl message.topCities}}</h2>\t                <ul class="drop-city-list u-clearfix">                        {{each data}}                           \t<li><a href="javascript:void(0);" title="${display}" data="${data}">${display}</a></li>                        {{/each}}\t                </ul>                <div class="foot-close"><a href="javascript:;" data="1" class="close-btn"><i class="fi fi-close"></i></a></div>            </div></div>',newSuggestion:function(t,e){switch(t){case"kr":return'<div id="ctripDestinaSelect">                <div class="m-droplist drop-top-city-picker hover-layout">                {{enum(key,arr) data}}                <div class="item-city {{if key==\'국내\'}}item-local{{/if}}">\t\t            <h2 class="mod-tit">${key}</h2>                    <ul class="drop-city-list u-clearfix">                    {{each arr}}\t\t\t            <li class="{{if $index % 5==0}}minwidth{{/if}}"><a href="javascript:void(0);" title="${display}" data="${data}">${display}</a></li>                    {{/each}}                    </ul>\t            </div>                {{/enum}}                <div class="foot-close"><a href="javascript:void(0);" data="1" class="close-btn"><i class="fi fi-close"></i></a></div>            </div></div>';case"jp":return'<div id="ctripDestinaSelect">            <div c-layout="tile" class="m-droplist drop-top-city-picker hover-layout">            {{enum(key,arr) data}}            <div class="item-city {{if key==\'日本\' || key==\'中華圏\' || key==\'韓国\'}}city-col-6{{/if}}">                <h2 class="mod-tit">${key}</h2>                <ul class="drop-city-list u-clearfix">                {{each arr}}                <li class="{{if display==\'プーケット\' || display==\'ハノイ\' || display==\'ケアンズ\' || display==\'ロンドン\'}}minwidth{{else display==\'シンガポール\' || display==\'クアラルンプール\' || display==\'ロサンゼルス\' || display==\'サンフランシスコ\'}}maxwidth{{/if}}"><a href="javascript:void(0);" title="${display}" data="${data}">${display}</a></li>                {{/each}}                </ul>            </div>            {{/enum}}            <div class="foot-close"><a href="javascript:;" data="1" class="close-btn"><i class="fi fi-close"></i></a></div>            </div></div>';case"hk":case"tw":switch(e){case"en":return'<div id="ctripDestinaSelect">                            <div c-layout="tile" class="m-droplist drop-top-city-picker hover-layout">                                {{enum(key,arr) data}}                                <div class="item-city">                                    <h2 class="mod-tit">${key}</h2>                                    <ul class="drop-city-list u-clearfix">                                    {{each arr}}                                        <li class="{{if $index % 5==2}}mw{{/if}}"><a href="javascript:void(0);" title="${display}" data="${data}">${display}</a></li>                                    {{/each}}                                    </ul>                                </div>                                {{/enum}}                            <div class="foot-close"><a href="javascript:;" data="1" class="close-btn"><i class="fi fi-close"></i></a></div>                            </div></div>';case"hk":case"tw":return'<div id="ctripDestinaSelect">                        <div c-layout="tile" class="m-droplist drop-top-city-picker hover-layout">                        {{enum(key,arr) data}}                        <div class="item-city city-col-6">                            <h2 class="mod-tit">${key}</h2>                            <ul class="drop-city-list u-clearfix">                            {{each arr}}                                <li><a href="javascript:void(0);" title="${display}" data="${data}">${display}</a></li>                            {{/each}}                            </ul>                        </div>                        {{/enum}}                        <div class="foot-close"><a href="javascript:;" data="1" class="close-btn"><i class="fi fi-close"></i></a></div>                        </div></div>'}break;case"en":case"sg":case"au":case"ru":return'<div id="ctripDestinaSelect">            <div c-layout="tile" class="m-droplist drop-top-city-picker hover-layout">            {{enum(key,arr) data}}            <div class="item-city">                <h2 class="mod-tit">${key}</h2>                <ul class="drop-city-list u-clearfix">                {{each arr}}                <li><a href="javascript:void(0);" title="${display}" data="${data}">${display}</a></li>                {{/each}}                </ul>            </div>            {{/enum}}            <div class="foot-close"><a href="javascript:;" data="1" class="close-btn"><i class="fi fi-close"></i></a></div>            </div></div>';default:return""}},newSuggestionStyle:"",filterStyle:"",filter:'<div class="drop-search-result drop-search-result_scroll" style="display:block">            <div class="drop-overflow-con">         {{if !hasResult}}    \t\t<p class="hd-tip error"> {{tmpl message.noFilterResult}}            </p>         {{/if}}           <ul class="drop-result-list">           {{if list}}                {{each (i,item) list}}                <li>                <a data="${data}">                <span class="drop-txt">${decodeURIComponent(data.split("|")[0])}                <span class="drop-item">${decodeURIComponent(data.split("|")[7])}</span></span>                </a></li>                {{/each}}            {{/if}}            </ul>            </div>        {{if isGoogle}}            <div class="powered-google-wrap"><span class="powered-google"></span></div>        {{/if}}        <div class="foot-close" onmousedown="this.parentNode.style.display=\'none\';"><a href="javascript:void(0)" class="close-btn"><i class="fi fi-close"></i></a></div>        </div>',message:{ButtonText_Close:a.locals.ButtonText_Close,typeORSelect:a.locals.typeORSelect,topCities:a.locals.topCities,filterResult:a.locals.filterResult.replace("{0}","jp"===__SITE_CONFIG__.page.site.toLowerCase()?"${htmlencode(val)}":'"${htmlencode(val)}"'),noFilterResult:a.locals.noFilterResult.replace("{0}","jp"===__SITE_CONFIG__.page.site.toLowerCase()?"${htmlencode(val)}":'"${htmlencode(val)}"')}},hook:{search:function(){}}},r=function(e,i){var o={minLength:1,relate:{cityId:"",optionid:"",optiontype:"",lat:"",lon:"",selectedValue:"",markland:"",optionName:"",placeId:"",position:"",timeoffset:""},display:{left:0,right:7,suggestion:1,value:1},css:{elName:"hotelsCity",errorState:"ipt-error"},alias:["display","selectedValue","cityId","optionid","optiontype","lat","lon","tag","markland","optionName","position","timeoffset","placeId","countryId"],i18n:{inputEmpty:"",sameInputValue:"",suggestionTitle:"",suggestionTip:"",childAge:""},filterFirstIndex:0,tmpl:{},suggestionSource:"",listeners:{onChange:function(){}},jsonpFilter:""};this.options=t.extend(!0,o,i),this.$el=t(e),this.ui={},this.ui.el=e,this.init()};r.prototype={init:function(){return this.findElements(),this.initAddress(),this.initTip(),this.initAdultSearch(),this},findElements:function(){this.options.css},getInputValue:function(){return this.ui.el.value().trim()},setInputValue:function(t){this.ui.el.value(t)},updateUserInput:function(e,i){var o=this.options.alias,a=this.options.relate;if(e&&e.length){this.ui.el.value(e[1]);for(var s=0,l=e.length;s<l;s++)a&&a[o[s]]&&a[o[s]].value&&a[o[s]].value(e[s]);var n=t("#timeOffset").value();if(!isNaN(n)){var r=t("#timeOffsetHid"),d=t("#txtCheckInDisplay");r.value(n);var c=this.getToday();if(d.data("minDate",c||"#"),d.value()){var h=new Date(d.data("currentDate"));h&&!isNaN(h)&&"Invalid Date"!==h.toString()&&new Date(h.getFullYear(),h.getMonth(),h.getDate())<c&&d.data("currentDate",c)&&d.focus()}}var p=i?t("#position").value():-1;isNaN(p)||this.recordSelection(e[1],p,t("#labelValueHid").value(),e[3],e[4])}else this.ui.el.value(""),this.clearRelate()},clearRelate:function(){var t=this.options.relate;for(var e in t)t[e].value&&t[e].value("")},initAddress:function(){var e=this,i=this.options,o=i.css,a=i.tmpl,s="",l=!1,n=!1;a.message.i18n=i.i18n,this.addrInstance=this.ui.el.regMod("address","1.0",{minLength:i.minLength,name:o.elName,delay:200,isAutoCorrect:!1,display:i.display,isFilterSelect:!0,keyboard:{up:!0,down:!0,left:!1,right:!1,enter:!0},relate:i.relate,offset:{top:this.$el.closest("div.mc-srh_ho__field-item").offset().bottom-this.$el.offset().bottom,left:this.$el.closest("div.mc-srh_ho__field-item").offset().left-this.$el.offset().left,position:5},source:{alias:i.alias,suggestion:i.suggestionSource},jsonpFilterInit:i.jsonpFilterInit,template:a,jsonpFilter:i.jsonpFilter,message:a.message}),this.addrInstance.method("bind","enter",function(){s=null,l=!1,n=!0}),this.addrInstance.method("bind","suggestion",function(t){s=null,l=!1,n=!1}),this.addrInstance.method("bind","userinput",function(o,a){var r="suggestionMousedown"===a.eventType||"keydown"===a.eventType,d="blur"!==a.eventType,c=t("#googlePlaceId").value();if(""!=c){var h=t("#hotelsCity").value(),p=i.jsonpFilter.replace("${encodeURIComponent(unescape(decodeURIComponent(key)))}",encodeURIComponent(h)).replace('&callback=filterCities("${encodeURIComponent(unescape(decodeURIComponent(key)))}")',"");e.getJSONP(p+"&placeId="+c,function(e){if(e.result.length>0){var i=e.result.split("|");t("#optionType").value("Markland"),t("#lat").value(i[1]),t("#lon").value(i[2]),t("#displayValue").value(i[0]),t("#markland").value(i[0]),t("#optionName").value(i[0]),n=!0}})}r&&a.data&&(e.updateUserInput(a.data.split("|"),d),n=!0,s=null),n||a.data||!s?l&&!a.data&&(e.updateUserInput("",""),i.listeners.onChange("","")):(e.updateUserInput(s,d),i.listeners.onChange(s,d),s=null),l=!1,n=!0;var u=e.getToday();t("#txtCheckInDisplay").data("minDate",u||"#")}),this.addrInstance.method("bind","filter",function(t,e){var o=e.find("a"),a=o.eq(i.filterFirstIndex).length?o.eq(i.filterFirstIndex).attr("data"):"";a?(s=decodeURIComponent(a).split("|"),n=!1):(l=!0,s=null)}),this.ui.el.on("keydown",function(t){}),this.ui.el.on("blur",function(){l&&!s&&(e.updateUserInput("",""),i.listeners.onChange("","")),!n&&s&&e.updateUserInput(s,!1),l=!1}),this.ui.el.on("focus",function(){e.hideTip()})},checkIfAvailable:function(t){var e=this.getInputValue();return e?t&&t===e?(this.showTip(this.options.i18n.sameInputValue),!1):(this.hideTip(),!0):(this.showTip(this.options.i18n.inputEmpty),!1)},createEl:function(e){var i=t(document.createElement("div"));return i.html(e),i.children()},initTip:function(){this.ui.error=this.createEl('<div class="mc-srh_ho__err-msg"></div>'),this.ui.error.hide(),this.ui.el.parents(".mc-srh_ho__field-item").append(this.ui.error)},showTip:function(t){this.ui.error.html(t).show(),this.ui.el.addClass(this.options.css.errorState)},hideTip:function(){this.ui.error.hide(),this.ui.el.removeClass(this.options.css.errorState)},getToday:function(){var e=t("#timeOffset"),i=t("#utcDateNow"),o=e.value();if(!o||isNaN(o))return new Date;var a=new Date(i.value());if(isNaN(a)||"Invalid Date"===a.toString())return new Date;var s=parseInt(o),l=a.addSeconds(s);return new Date(l.getFullYear(),l.getMonth(),l.getDate())},recordSelection:function(e,i,o,a,s){t.ajax("//"+window.location.host+"/hotels/tool/SelectSearchResult?st=hotel&word="+encodeURIComponent(e)+"&position="+i+"&optionId="+a+"&optionType="+s+"&type=key&label="+o)},getJSONP:function(t,e){if(t){var i=["a","b","c","d","e","f","g","h","i","j"],o=Math.floor(10*Math.random()),a=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),l="getJSONP"+i[o]+i[a]+i[s];t+=t.indexOf("?")===-1?"?callback="+l:"&callback="+l,e&&(window[l]=e);var n=document.createElement("script");n.addEventListener?n.onload=function(){delete window[l],n.parentNode.removeChild(n)}:n.onreadystatechange=function(){"complete"==n.readyState&&(delete window[l],n.parentNode.removeChild(n))},n.src=t,document.getElementsByTagName("head")[0].appendChild(n)}},initAdultSearch:function(){var e=this;t("#childage").on("click",".o-counter__minus, .o-counter__plus",function(){e.changeAdultCounter(this)}),this.setAdultStatus(),t("#childage").on("click","label.js-dropdown-click",function(){t("#childage > div.js-dropdown-con").toggleClass("is-active")}),t("#childage").on("click",".fi-close",function(){t("#childage > div.js-dropdown-con").removeClass("is-active")}),t("div.mc-srh_ho__field-purpose").on("click","label",function(){t(this).siblings().removeClass("is-checked"),t(this).addClass("is-checked")}),t(document).on("click",function(e){e=e||window.event,e.target&&t(e.target).parents("#childage").length<=0&&t("#childage > div.js-dropdown-con").removeClass("is-active")}),this.initAdultHistory()},initAdultHistory:function(){var e=t.storage.get(this.options.opt.localStoreKey),i=t.parseJSON(e);if(i&&0!=i.length&&!(!i[0].Adult||parseInt(i[0].Adult)<1||parseInt(i[0].Adult)>8)&&!(!i[0].Children||parseInt(i[0].Children)<0||parseInt(i[0].Children)>3)&&(t("#childage").find("#adultCount").text(i[0].Adult),t("#childage").find("#childrenCount").text(i[0].Children),this.setAdultStatus(),t("#childage div.ages").remove(),i[0].Children>0))for(var o=i[0].Ages.split(","),a=0;a<o.length;a++)this.addChildAge(o[a])},showAdultSearch:function(){var e=parseInt(t("#childage").find("#adultCount").text());if(0==e){t("#childage").find("#adultCount").text(1);var i=t("span.adultSpan");i.length&&i.text(1)}},changeAdultCounter:function(e){var i=t(e).hasClass("is-disabled");if(!i){var o=parseInt(t(e).parent().find(".o-counter__num").text()),a=t(e).parent().data("type");t(e).hasClass("o-counter__minus")&&(o--,"child"==a&&(t("#childage div.mc-srh_ho__child-age-cnt select").last().remove(),0==o&&t("#childage span.mc-srh_ho__child-age-tit").hide())),t(e).hasClass("o-counter__plus")&&(o++,"child"==a&&this.addChildAge()),t(e).parent().find(".o-counter__num").text(o),this.setAdultStatus()}},setAdultStatus:function(){t("#childage span.o-counter__num").each(function(e){var i=parseInt(e.text());e.siblings().removeClass("is-disabled"),t("#childage-tips").show(),i<=parseInt(e.data("min"))?(e.parent().find(".o-counter__minus").addClass("is-disabled"),t("#childage-tips").hide()):i>=parseInt(e.data("max"))&&e.parent().find(".o-counter__plus").addClass("is-disabled")});var e=parseInt(t("#adultCount").text()),i=parseInt(t("#childrenCount").text()),o="KR"===__SITE_CONFIG__.page.site?"명":"JP"===__SITE_CONFIG__.page.site?"名":"",s=e+" "+(e>1?this.options.i18n.Adults:this.options.i18n.Adult)+", "+i+" "+(i>1?this.options.i18n.Children:this.options.i18n.Child);a.methods&&a.methods.singularOrPlural&&(s=e+" "+a.methods.singularOrPlural.adult(e)+", "+i+" "+a.methods.singularOrPlural.child(i)),o&&(s=(e>1?this.options.i18n.Adults:this.options.i18n.Adult)+" "+ +e+o+", "+(i>1?this.options.i18n.Children:this.options.i18n.Child)+" "+i+o),t("#childage span.mc-srh_ho__input-txt").text(s)},addChildAge:function(e){var i='<option value="0">&lt;1</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option>',o=document.createElement("select");o.className+="mc-srh_ho__child-age-sel",t(o).html(i),t(o).appendTo(t("#childage div.mc-srh_ho__child-age-cnt")),e&&t("#childage div.mc-srh_ho__child-age-cnt select").last().value(e),t("#childage span.mc-srh_ho__child-age-tit").show()}};var d=function(e){this.options=t.extend(!0,n,e),this.ui={},this.data={}};return d.prototype={constructor:d,init:function(){return this.$el=this.render(),this.ui.el=this.$el,this.getElements(),this.initRelate(),this.initSearchData(),this.initCalendar(),this.bindEvents(),this.loadLabel(),this},initRelate:function(){this.data.relate={cityId:this.ui.hotelsCityHid,city:this.ui.hotelsCityHid,optionid:this.ui.optionIdHid,optiontype:this.ui.optionTypeHid,lat:this.ui.latHid,lon:this.ui.lonHid,selectedValue:this.ui.displayValueHid,markland:this.ui.markLandHid,
optionName:this.ui.optionNameHid,placeId:this.ui.googlePlaceIdHid,position:this.ui.positionHid,countryId:this.ui.countryIdHid,checkin:this.ui.txtCheckIn,checkout:this.ui.txtCheckOut,googlePlaceId:this.ui.googlePlaceIdHid,display:this.ui.hotelsCity}},initSearchData:function(){this.options.searchData?this.data.searchData=this.options.searchData:this.loadSearchData()&&(this.data.searchData=this.loadSearchData()),this.data.searchData&&this.setSearchData(this.data.searchData)},setSearchData:function(t){for(var e in this.data.relate)this.data.relate[e].value&&("undefined"!=t[e]&&"undefined"!=typeof t[e]?this.data.relate[e].value(t[e]):this.data.relate[e].value(""));t.starlist&&this.setStars(t.starlist),t.checkin&&(this.ui.txtCheckOutDisplay.data("minDate",new Date(t.checkin.replace(/\//g,"-"))),this.ui.txtCheckOutDisplay.data("maxDate",new Date(t.checkin.replace(/\//g,"-")).addDays(28)))},getSearchData:function(){var t={};for(var e in this.data.relate)this.data.relate[e].value&&"undefined"!=this.data.relate[e].value()&&(t[e]=this.data.relate[e].value());return t.starlist=this.getStars(),t},storeSearchData:function(e){t.storage.set(this.options.storeSearchDataKey,e||this.getSearchData())},showSearching:function(){t("#homesearch-btn").hide(),t("#homesearch-btn-loading").show()},hideSearching:function(){t("#homesearch-btn-loading").hide(),t("#homesearch-btn").show()},loadSearchData:function(){var e=t.storage.get(this.options.localStoreKey),i=function(t){return decodeURIComponent(t)},o={};if(e){var a=t.parseJSON(e);if(0==a.length)return o;o={cityId:a[0].City,city:a[0].City,optionid:a[0].Oi,optiontype:a[0].Ot,markland:i(a[0].Ml),optionName:a[0].On,placeId:a[0].Gi,countryId:a[0].Country,checkin:i(a[0].Ci.replace(/\//g,"-")),checkout:i(a[0].Co.replace(/\//g,"-")),googlePlaceId:a[0].Gi,display:i(a[0].Dv||a[0].On)},a[0].Lat!=-1&&a[0].Lon!=-1&&0!=a[0].Lat&&0!=a[0].Lon&&(o.lat=a[0].Lat,o.lon=a[0].Lon)}return o},initAddress:function(){var t=1,e=this.options,i=__SITE_CONFIG__.page.site.toLowerCase(),o=__SITE_CONFIG__.page.language.toLowerCase(),s=["en","kr","jp","hk","sg","ru","au","tw"].indexOf(o)!=-1;this.data.addressInst=new r(this.ui.hotelsCity,{minLength:t,opt:this.options,relate:{cityId:this.ui.hotelsCityHid,optionid:this.ui.optionIdHid,optiontype:this.ui.optionTypeHid,lat:this.ui.latHid,lon:this.ui.lonHid,selectedValue:this.ui.displayValueHid,markland:this.ui.markLandHid,optionName:this.ui.optionNameHid,placeId:this.ui.googlePlaceIdHid,position:this.ui.positionHid,timeoffset:this.ui.timeOffsetHid,countryId:this.ui.countryIdHid},display:{left:0,right:7,suggestion:1,value:1},css:{elName:"hotelsCity",errorState:"ipt-error"},alias:["display","selectedValue","cityId","optionid","optiontype","lat","lon","tag","markland","optionName","position","timeoffset","placeId","countryId"],i18n:{inputEmpty:a.locals.CheckTip_InputCity,sameInputValue:"",suggestionTitle:"",suggestionTip:"",Adult:a.locals.Adult,Adults:a.locals.Adults,Child:a.locals.Child,Children:a.locals.Children,childAge:a.locals.ChildAge},filterFirstIndex:0,tmpl:{message:e.template.message,suggestion:s?e.template.newSuggestion(i,o):e.template.suggestion,suggestionStyle:s?e.template.newSuggestionStyle:"",filter:e.template.filter,filterStyle:e.template.filterStyle,filterPageSize:15},suggestionSource:s?a.data.cityPicker:a.data.suggestion,listeners:{onChange:function(){}},jsonpFilter:e.hotelKeywordUrl+"&label="+this.ui.labelValueHid.value()})},getElements:function(){var t=this.options.css;this.ui.form=this.$el.find(t.form),this.ui.hotelsCity=this.$el.find(t.hotelsCity),this.ui.txtCheckInDisplay=this.$el.find(t.txtCheckInDisplay),this.ui.txtCheckIn=this.$el.find(t.txtCheckIn),this.ui.txtCheckOutDisplay=this.$el.find(t.txtCheckOutDisplay),this.ui.txtCheckOut=this.$el.find(t.txtCheckOut),this.ui.nightsTip=this.$el.find(t.nightsTip),this.ui.starPanel=this.$el.find(t.starPanel),this.ui.searchBtn=this.$el.find(t.searchBtn),this.ui.hotelsCityHid=this.$el.find(t.hotelsCityHid),this.ui.optionIdHid=this.$el.find(t.optionIdHid),this.ui.optionTypeHid=this.$el.find(t.optionTypeHid),this.ui.latHid=this.$el.find(t.latHid),this.ui.lonHid=this.$el.find(t.lonHid),this.ui.displayValueHid=this.$el.find(t.displayValueHid),this.ui.markLandHid=this.$el.find(t.markLandHid),this.ui.optionNameHid=this.$el.find(t.optionNameHid),this.ui.googlePlaceIdHid=this.$el.find(t.googlePlaceIdHid),this.ui.labelValueHid=this.$el.find(t.labelValueHid),this.ui.utcDateNowHid=this.$el.find(t.utcDateNowHid),this.ui.timeOffsetHid=this.$el.find(t.timeOffsetHid),this.ui.positionHid=this.$el.find(t.positionHid),this.ui.countryIdHid=this.$el.find(t.countryIdHid),this.ui.hr2=this.$el.find(t.hr2),this.ui.hr3=this.$el.find(t.hr3),this.ui.hr4=this.$el.find(t.hr4),this.ui.hr5=this.$el.find(t.hr5)},initCalendar:function(){var o=this,a=new Date,s=a,l=s.addDays(1),n={top:9,left:-15};if(this.data.searchData&&this.data.searchData.checkin&&this.data.searchData.checkout){var r=this.data.searchData.checkin,d=this.data.searchData.checkout;e.isBefore(a,r)&&(s=e.createDate(r),l=e.createDate(d))}var c={minDate:a,maxDate:null,nextInput:[this.ui.txtCheckOutDisplay],nextInputRelate:[this.ui.txtCheckOut],nextInterval:1,relate:[this.ui.txtCheckIn],relateDisplay:null,defaultDate:s,offset:n},h={styles:'.clearfix:before,.clearfix:after{content:"";display:table;}.clearfix:after{clear:both;}.clearfix{*zoom:1;}.m-cld{width:550px;border:1px solid #ddd;color:#234;background-color:#fff;box-shadow:0 2px 4px rgba(0,0,0,0.15);}.cld-hd{position:relative;}.m-cld .prev-btn:before{content:"\\e32a";}.m-cld .next-btn:before{content:"\\e28a";}.m-cld .prev-btn,.m-cld .next-btn{ font-size: 18px; position: absolute;color:#666;cursor:pointer;top:12px;}.m-cld .prev-btn:hover,.m-cld .next-btn:hover{color:#2681ff;}.m-cld .disabled .prev-btn,.m-cld .disabled .next-btn{color:#ddd;cursor: default;}.m-cld .prev-btn{left:20px;}.m-cld .next-btn{right:20px;}.cld-hd .arrow-box{*text-align:center;*top:12px;*display:block;* width:22px;*border:1px solid #999;*position:absolute;*cursor:pointer;*left:38px;*padding-top:5px;*height:17px;}.cld-hd .arrow-box-next{*left:auto;*right:38px;}.cld-hd .arrow-box:hover{*border-color:#1171b7;}.cld-hd .prev-btn,.cld-hd .next-btn{*position: static;*display:inline-block;*width:7px;*height:12px;*background:url(http://pic.english.c-ctrip.com/common_v3/calender-sprite.png) no-repeat 1024px 1024px;}.cld-hd .prev-btn,.cld-hd .arrow-box.disabled:hover .prev-btn{*background-position:-150px -8px;}.cld-hd .next-btn,.cld-hd .arrow-box.disabled:hover .next-btn{*background-position:-139px -8px;}.cld-hd .arrow-box:hover .prev-btn{*background-position:-150px -24px;}.cld-hd .arrow-box:hover .next-btn{*background-position:-139px -24px;}.cld-hd .arrow-box.disabled{*opacity:.4;*filter:alpha(opacity=40);*cursor:default;}.cld-hd .arrow-box.disabled:hover{*border-color:#999;}.cld-hd .month-label{float:left;width:50%;*width:49.3%;box-sizing:border-box;text-align:center;font-size:18px;}.cld-hd .month-label.month-label-1st{padding-left:7px;}.cld-hd .month-label.month-label-2st{padding-right:7px;}.month-hd{padding:12px 0;}.week-hd{box-sizing:border-box;list-style:none;float:left;width:50%;text-align:center;padding:0 7px 2px 14px; margin-bottom:10px;*width: 43%;}.week-hd li{float:left;width:14.28%;font-size:13px;}.week-hd li.weekend,.cld-bd .date-tbl td .weekend{color:#2d64b3;}.week-hd-2nd{padding:0 14px 0 7px;}.cld-bd{padding:0 7px;}.cld-bd .month-con{width:50%;float:left;padding:0 7px;box-sizing: border-box;*width: 45%;}.cld-bd .date-tbl{width:100%;border-collapse:collapse;}.cld-bd .date-tbl td{text-align:center; font-size:14px;padding:0;width:14.28%;}.cld-bd .date-tbl td .festival-dot{top:3px;right:3px;background-color:#ccc;position:absolute;width:6px;height:6px;border-radius:6px;}.cld-bd .date-tbl td .cell{position:relative;padding:8px 0;cursor:pointer; line-height: 1.3;*line-height: 1.1;}.cld-bd .date-tbl td .cell:hover{background:#5aa0ff;color:#fff;}.cld-bd .date-tbl td .past-date{color:#ccc;cursor:default;}.cld-bd .date-tbl td .past-date:hover{color:#ccc;background-color:#fff;}.cld-bd .date-tbl td .active,.cld-bd .date-tbl td .active:hover{background:#2681ff;color:#fff;}.cld-bd .date-tbl td .interval{background:#5aa0ff;color:#fff;}.cld-bd .date-tbl td .past-date:hover .festival-dot{background-color:#ccc;}.cld-bd .festival-list{list-style:none;padding:0;font-size:12px;margin:6px 0 0;}.cld-bd .festival-list li{float:left;margin-right:10px;color:#999;*width:100%;}.cld-bd .festival-list li .festival-dot{background-color:#ccc;width:6px;height:6px;display:inline-block;vertical-align:middle;border-radius:6px;margin-right:5px;*display:inline;*zoom:1;}.cld-ft{position:relative;min-height:30px;}.cld-ft .local-list{color:#999; font-size: 12px; padding-left: 14px;}.cld-ft .local-list li{float:left; margin-right:10px;}.cld-ft .close-btn{cursor: pointer;text-align: center;position: absolute;float: right;width: 24px;height: 24px;line-height: 24px;right: 8px;bottom: 8px;font-size: 16px;color: #999;}.cld-ft .close-btn:hover{color: #2681FF;}.cld-single{width:325px}.cld-single .week-hd{ padding-right: 29px;}.cld-single .cld-hd .month-label,.cld-single .cld-hd .week-hd,.cld-single .cld-bd .month-con{width:100%;}.cld-single .month-2nd,.cld-single .month-label-2nd,.cld-single .week-hd-2nd{display:none;}.cld-price{width:680px;}.cld-price .date-tbl td{ font-size:16px;}.cld-price .date-tbl td .interval .price{ color: #fff;}.cld-bd .date-price td .price{font-size:12px;color:#91aebf;}.cld-bd .date-price td .cell:hover .price{color:#fff;}.cld-bd .date-price td .active .price{color:#fff;}.cld-bd .date-price td .lowest .price{color:#ff6666;}.cld-bd .date-price td .lowest:hover .price{color:#ff6666;}@media only screen and (max-width:768px){.m-cld{width:360px}.cld-hd .month-label,.cld-hd .week-hd,.cld-bd .month-con{width:100%;}.month-2nd,.month-label-2nd,.week-hd-2nd{display:none;}.cld-ft .local-list{ padding-bottom:8px;}}@media only screen and (max-width:500px){.m-cld{width:100%}}'};"jp"===__SITE_CONFIG__.page.site.toLowerCase()&&t.extend(c,{displayDateFormat:"yyyyMMddww"}),this.checkInInst=new i(this.ui.txtCheckInDisplay,{options:c,template:h,listeners:{onChange:function(){o.updateNightsTip(),o.ui.txtCheckOutDisplay.data("maxDate",this.currentDate.addDays(28))},onShow:function(){}}});var p={minDate:a.addDays(1),maxDate:a.addDays(28),relate:[this.ui.txtCheckOut],relateDisplay:null,defaultDate:l,offset:n};"jp"===__SITE_CONFIG__.page.site.toLowerCase()&&t.extend(p,{displayDateFormat:"yyyyMMddww"}),this.checkOutInst=new i(this.ui.txtCheckOutDisplay,{options:p,template:h,listeners:{onChange:function(){o.updateNightsTip()},onShow:function(){}}}),this.updateNightsTip()},updateNightsTip:function(t){t=t||e.daysOfDate(e.createDate(this.ui.txtCheckIn.value()),e.createDate(this.ui.txtCheckOut.value())),this.ui.nightsTip.html(t+" "+a.locals.Hotel_Book_YourBook_Nights_V2)},render:function(){function e(t){var e=document.createElement("style");e.type="text/css",e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),document.getElementsByTagName("head")[0].appendChild(e)}var i='@charset "UTF-8";.mc-srh_ho{background-color:#fff;border-radius:4px;padding:16px 16px 16px 21px;display:none}@media screen and (max-width:1020px){.mc-srh_ho{padding-right:19px}}.mc-srh_ho__field-group{float:left;position:relative;border:1px solid #ddd;margin-left:-1px;box-sizing:border-box}.mc-srh_ho__field-dropdown .fi-arrow-down{position:absolute;width:24px;height:24px;right:10px;top:50%;margin-top:-10px;color:#787878;font-size:18px;line-height:24px;text-align:center}.mc-srh_ho__field-dropdown .mc-srh_ho__field-block{padding-right:40px}.mc-srh_ho__item-con{float:left;box-sizing:border-box}.mc-srh_ho__field-item{position:relative;cursor:pointer;border-bottom:2px solid transparent;line-height:18px}.mc-srh_ho__field-item.is-active{border-color:#2681ff}.mc-srh_ho__field-item.is-active .mc-srh_ho__dropdown{display:block}.mc-srh_ho__dropdown{position:absolute;min-width:100%;background-color:#fff;border:1px solid #ddd;z-index:1;display:none;margin-top:2px;cursor:default}.mc-srh_ho__dropdown-cnt{padding:0 15px}.mc-srh_ho__guest-record{padding:0 10px}.mc-srh_ho__dropdown-tips{color:#999;line-height:1.2}.mc-srh_ho__dropdown-sp-line{border-top:1px solid #ccc;margin:10px 0}.mc-srh_ho__dropdown-err-msg{background-color:#d9563a;color:#fff;line-height:1.2;padding:8px 25px;margin-bottom:20px}.mc-srh_ho__err-msg{display:none;position:absolute;line-height:1.2;margin-bottom:59px;bottom:0;color:#fff;font-size:12px;border:1px solid #d9481b;padding:8px 10px;left:-1px;background-color:#d9481b;max-width:100%}.mc-srh_ho__err-msg:before{position:absolute;border:9px solid transparent;border-top:9px solid #d9481b;content:"";left:20px;bottom:-18px}.mc-srh_ho__field-block{padding:6px 15px 6px 15px;cursor:pointer;display:block;overflow:hidden}.mc-srh_ho__swap{width:24px;height:24px;line-height:24px;position:absolute;margin-left:-12px;margin-top:20px;left:50%;text-align:center;color:#787878;cursor:pointer;user-select:none}.mc-srh_ho__swap .fi{font-size:20px;line-height:20px;vertical-align:middle}.mc-srh_ho__swap:hover{color:#2681ff}.mc-srh_ho__date-sp{position:absolute;width:16px;height:16px;margin-left:-8px;margin-top:24px;left:50%;text-align:center}.mc-srh_ho__date-sp-line{display:inline-block;border-bottom:1px solid #ddd;width:14px;vertical-align:middle}.mc-srh_ho__label-txt{font-size:12px;color:#999;line-height:1.2;vertical-align:bottom;display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;*display:inline;*zoom:1}.mc-srh_ho__input-con{display:block}.mc-srh_ho__input,.mc-srh_ho__input-txt{border:0 none;margin:0;vertical-align:top;font-size:16px;padding:5px 0 4px 0;line-height:1.3;height:20px;box-sizing:content-box;width:100%}.mc-srh_ho__input-txt:focus,.mc-srh_ho__input:focus{outline:0}.mc-srh_ho__input-txt{display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mc-srh_ho__btn-search{float:right;font-size:18px;color:#fff;height:50px;line-height:50px;border:0 none;background:#ff8d00;background:linear-gradient(to right,#ffa900 0,#ffa900 10%,#ff7200 90%,#ff7200 100%);border-radius:4px;min-width:220px;padding:0 16px}.mc-srh_ho__btn-search:hover{background:#ff6000}.mc-srh_ho__btn-search .mc-loading-24-white{display:none}.mc-srh_ho__btn-search.is-loading .mc-loading-24-white{display:inline-block}.mc-srh_ho__text-snippet{float:right;margin-right:12px;font-size:12px;color:#666;text-align:right;line-height:1.2;margin-top:10px}.mc-srh_ho.is-active{display:block}.mc-srh_ho__group-dest{width:40%;*width:39.5%}.mc-srh_ho__group-dest .mc-srh_ho__item-con{width:100%}@media screen and (max-width:1020px){.mc-srh_ho__group-dest{width:100%;margin-bottom:-1px}}.mc-srh_ho__group-date{width:33%}@media screen and (max-width:1020px){.mc-srh_ho__group-date{width:60%}}.mc-srh_ho__field-checkin{width:50%;*width:43.5%;padding-right:24px}.mc-srh_ho__field-checkout{width:50%;*width:43.5%;padding-left:24px}.mc-srh_ho__date-sp{width:48px;height:48px;margin-left:-24px;margin-top:6px;color:#999}.mc-srh_ho__nights{text-align:center;width:48px;padding-top:8px}.mc-srh_ho__nights-num{display:block;line-height:1.2}.mc-srh_ho__nights-txt{display:block}.mc-srh_ho__group-option{width:27%}@media screen and (max-width:1020px){.mc-srh_ho__group-option{width:40%;width:calc(40% + 1px)}}.mc-srh_ho__more-field{margin-top:12px;float:left}.mc-srh_ho__more-field-item{position:relative;float:left}.mc-srh_ho__more-field-item .mc-srh_ho__label-txt{display:inline-block;margin-bottom:6px}.mc-srh_ho__field-purpose{margin-right:50px}.mc-srh_ho__field-purpose .o-radiobox-c{margin-right:15px}.mc-srh_ho__star-item{display:inline-block;background-color:#f5f5f5;cursor:pointer;padding:0 5px}.mc-srh_ho__star-item:hover{background-color:#eee}.mc-srh_ho__star-item:hover .fi-hotel-star-o{color:#ff9600}.mc-srh_ho__star-item .fi{font-size:14px;line-height:14px;vertical-align:middle;position:relative;top:-1px}.mc-srh_ho__star-item.is-active .fi-hotel-star-o{color:#ff9600}.mc-srh_ho__star-item.is-active .fi-hotel-star-o:before{content:""}.mc-srh_ho__star-num{vertical-align:middle;margin-right:1px}.mc-srh_ho__dropdown-option{min-width:330px;right:-1px}.mc-srh_ho__dropdown-option .mc-srh_ho__dropdown-cnt{padding:10px 15px 5px 15px}.mc-srh_ho__tips-number{margin-top:10px}.mc-srh_ho__child-age{margin-bottom:12px}.mc-srh_ho__child-age-tit{font-size:14px;display:block;margin-bottom:4px}.mc-srh_ho__child-age-cnt{margin-right:-20px}.mc-srh_ho__child-age-sel{font-size:14px;padding:4px 8px;float:left;margin-right:16px;margin-bottom:8px;width:80px}.mc-srh_ho__action{margin-top:16px;margin-right:4px;float:right}@media screen and (max-width:1020px){.mc-srh_ho__action{margin-right:1px}}.mc-srh_ho__btn-search-txt{vertical-align:middle}.mc-srh_ho .mc-loading-24-white{margin-right:8px}.mc-srh_ho__close-con{margin-top:-20px;padding:8px;*zoom:1}.mc-srh_ho__close-con:after,.mc-srh_ho__close-con:before{content:"";display:table}.mc-srh_ho__close-con:after{clear:both}.mc-srh_ho__close-btn{width:24px;height:24px;line-height:24px;text-align:center;display:inline-block;float:right;font-size:16px;color:#999;cursor:pointer}.mc-srh_ho__close-btn:hover{color:#2681ff}.mc-srh_ho_jp .mc-srh_ho__group-dest{width:35%}.mc-srh_ho_jp .mc-srh_ho__group-date{width:38%}.drop-search-result,.drop-top-city-picker{background-color:#fff;border:1px solid #ddd;box-shadow: 0 2px 4px rgba(0,0,0,0.15);}.drop-search-result_scroll .drop-overflow-con{max-height:262px;overflow-y:auto;}.drop-search-result .hd-tip,.drop-top-city-picker .hd-tip{color:#666;padding:10px 16px;background:#f7f7fb;font-size: 12px;line-height: 18px;}.drop-search-result .foot-close,.drop-top-city-picker .foot-close{ text-align:right;padding:8px;}.drop-search-result .foot-close a{ text-decoration:none;}.drop-search-result .foot-close a:hover,.drop-top-city-picker .foot-close a:hover{color: #2681ff;}.drop-search-result .error,.drop-top-city-picker .error{color: #d9563a;}.drop-search-result{ width:559px;}.drop-search-result .drop-result-list li{cursor:pointer; font-size:12px;color:#333;}.drop-search-result .drop-result-list li a{color:#666;padding:7px 0 7px 16px;position:relative;display:block;line-height: 18px;}.drop-search-result .drop-result-list li a:hover,.drop-search-result .drop-result-list li a.hover,.drop-search-result .drop-result-list .rsl-item:hover a{color:#fff;text-decoration:none;background: #5aa0ff;}.drop-search-result .drop-result-list li strong{color: #2681ff;font-weight:normal;}.drop-search-result .drop-result-list li:hover strong,.drop-search-result .drop-result-list li a.hover strong,.drop-search-result .drop-result-list li:hover .fi,.drop-search-result .drop-result-list li a.hover .fi{color:#fff;}.drop-search-result .drop-result-list .rsl-item{border-top:1px solid #dedede;padding-top:5px; margin-top:5px;}.drop-search-result .drop-result-list .drop-item{ position:absolute;top:4px;right:16px;color:#999;}.drop-search-result .drop-result-list li:hover .drop-item,.drop-search-result .drop-result-list li a.hover .drop-item{color:#fff;}.drop-search-result .drop-result-list .drop-txt{ display:inline-block;width:66%;white-space:normal;}.drop-search-result .drop-result-list .rsl-item .drop-txt, .drop-search-result .drop-result-list .rsl-item a.hover .drop-txt{ width:70%;}.drop-search-result .drop-result-list .fi{ font-size: 18px;color: #C4D4E9; vertical-align: middle; margin-left: 8px;}.drop-search-result .foot-close .close-btn{display:inline-block;cursor:pointer;width:24px;height:24px;line-height: 24px;text-align: center;font-size: 16px;color: #999;}.drop-search-result .foot-close .close-btn:hover{color: #2681ff}.drop-top-city-picker{width:640px;}.drop-top-city-picker .mod-tit{font-weight: normal;font-size:14px;color:#234;background-color: #f7f7fb;padding:8px 15px;}.drop-top-city-picker .drop-city-list{padding: 6px 10px;}.drop-top-city-picker .drop-city-list li{width:20%;float:left;*width:130px;}.drop-top-city-picker .drop-city-list li.mw{width:17%;}.drop-top-city-picker .drop-city-list li a{display:block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:14px;color: #223344;padding:5px 5px;height:20px; line-height:20px;}.drop-top-city-picker .drop-city-list li a:hover{ background-color: #5aa0ff;color:#fff; text-decoration:none;}.drop-top-city-picker .foot-close{background:none;border-top:none;padding:0 8px 8px; margin:0;}.drop-top-city-picker .city-col-6 li{width:16%;}.drop-top-city-picker .city-col-6 .drop-city-list{ padding-left:10px;padding-right:10px;}.drop-top-city-picker .foot-close .close-btn{display:inline-block;cursor:pointer;width:24px;height:24px;line-height: 24px;text-align: center;font-size: 16px;color: #999;}.drop-top-city-picker .foot-close .close-btn:hover{color: #2681ff}';return e(i),this.createEl(t.tmpl.render(this.options.template.body,{i18n:a.locals,hasTitle:this.options.hasTitle,title:this.options.title}))},createEl:function(e){var i=t(document.createElement("div"));return i.html(e),i.children()},isActive:function(){return"block"===this.$el.css("display")},searchBefore:function(t){if(this.options.hook&&this.options.hook.search&&"function"==typeof this.options.hook.search)try{t.name="hotels",this.options.hook.search(t)}catch(e){throw new Error(e)}},show:function(){this.$el&&this.$el.show()},hide:function(){this.$el&&this.$el.hide()},buildUrl:function(){var e="/hotels/list",i={};if(this.ui.hotelsCityHid.length){var o=this.ui.hotelsCityHid.value();e+="?city="+this.ui.hotelsCityHid.value(),i.City=o}t("#countryId").length>0&&(i.Country=t("#countryId").value()),e+="&checkin="+(i.Ci=this.ui.txtCheckIn.value()),e+="&checkout="+(i.Co=this.ui.txtCheckOut.value());var a=this.getStars();a.length>0&&(a="0,1,2,3,4,5"==a?"":"&starlist="+(i.Star=a)),e+=a,""!=this.ui.optionIdHid.value()&&(e+="&optionId="+(i.Oi=this.ui.optionIdHid.value())),""!=this.ui.optionTypeHid.value()&&(e+="&optionType="+(i.Ot=this.ui.optionTypeHid.value())),""!=this.ui.optionNameHid.value()&&(e+="&optionName="+(i.On=encodeURIComponent(this.ui.optionNameHid.value()))),""!=this.ui.latHid.value()&&"-1.0"!=this.ui.latHid.value()&&""!=this.ui.lonHid.value()&&"-1.0"!=this.ui.lonHid.value()&&"0"!=this.ui.lonHid.value()&&"0"!=this.ui.latHid.value()&&(e+="&lat="+(i.Lat=this.ui.latHid.value())+"&lon="+(i.Lon=this.ui.lonHid.value())),""!=this.ui.hotelsCity.value()&&(e+="&display="+(i.Dv=encodeURIComponent(this.ui.hotelsCity.value()))),""!=this.ui.markLandHid.value()&&(e+="&markland="+(i.Ml=encodeURIComponent(this.ui.markLandHid.value()))),""!=this.ui.googlePlaceIdHid.value()&&(e+="&googlePlaceId="+(i.Gi=this.ui.googlePlaceIdHid.value()));var s=t("#childage:visible");if(s.length){var l=s.find("#adultCount").text(),n=s.find("#childrenCount").text(),r=s.find("select.mc-srh_ho__child-age-sel"),d=[];r.length&&t(r).each(function(t){d.push(parseInt(t.value()))}),e+="&adult="+l,e+="&children="+n,e+="&ages="+d.join(),i.Adult=l,i.Children=n,i.Ages=d.join()}var c=t("div.mc-srh_ho__field-purpose label.is-checked");if(c.length){var h=c.data("purpose");e+="&travelpurpose="+h}e+="&label="+this.ui.labelValueHid.value(),this.setSearchHistory(i),window.location.href=e+"#ctm_ref=ix_sb_dl"},getStars:function(){var t=this.options.css,e=[];return this.ui.starPanel.find(t.starItem).each(function(i,o){i.hasClass(t.starChecked)&&e.push(i.attr("value"))}),e.join(",")},setStars:function(t){var e=this.options.css;this.ui.starPanel.find(e.starItem).each(function(i,o){t.indexOf(i.attr("value"))>=0&&i.addClass(e.starChecked)})},checkFormIsAvailable:function(){if(this.data.addressInst.checkIfAvailable())return!0},updateStartsState:function(){var t=this.options.css,e=this.ui.starPanel.find(t.starItem),i=[];e.each(function(e){e.hasClass(t.starChecked)&&i.push(parseInt(e.attr("index"),10))}),i.length>=2?e.slice(i[0],i[i.length-1]).each(function(e){e.addClass(t.starChecked)}):e.eq(i[0],i[0]+1).addClass(t.starChecked)},bindEvents:function(){var e=this,i=this.options.css;this.ui.starPanel.on("click",i.starItem,function(o){if(o.preventDefault(),"SPAN"===o.target.nodeName||"I"===o.target.nodeName){var a=t(this);a.hasClass(i.starChecked)?a.removeClass(i.starChecked):a.addClass(i.starChecked),e.updateStartsState()}}),this.ui.searchBtn.on("click",function(t){t.preventDefault(),e.showSearching(),e.checkFormIsAvailable()?(e.storeSearchData(),e.searchBefore(e.loadSearchData()),e.buildUrl(),/(iPhone|iPad|iPod)/i.test(navigator.userAgent)&&e.hideSearching()):e.hideSearching()}),this.$el.on("focus","#txtCheckInDisplay, #txtCheckOutDisplay, #hotelsCity",function(){t(this).closest("div.mc-srh_ho__field-item").addClass("is-active")}).on("blur","#txtCheckInDisplay, #txtCheckOutDisplay, #hotelsCity",function(){t(this).closest("div.mc-srh_ho__field-item").removeClass("is-active")})},setSearchHistory:function(e){var i=this.options.localStoreKey,o=[],a={};if(e){var s=function(t){return decodeURIComponent(t)};for(var l in e)a[l]=s(e[l]||"");a.Ci=s(a.Ci.replace(/-/g,"/")),a.Co=s(a.Co.replace(/-/g,"/"));var n=t.storage.get(i);if(n){o=t.parseJSON(n);for(var r=0;r<o.length;r++){var d=o[r],c=!0;for(var h in d)"Ci"!=h&&"Co"!=h&&"Dv"!=h&&"On"!=h&&"Ml"!=h&&"Country"!=h&&d[h]!=a[h]&&(c=!1);c&&o.splice(r,1)}o.length>=5&&o.pop()}o.unshift(a),t.storage.set(i,decodeURIComponent(t.stringifyJSON(o))),t.storage.expire(i,43200)}},loadLabel:function(){var e=this;t.ajax("//"+window.location.host+"/hotels/home/label",{async:!0,cache:!1,onsuccess:function(t){if(t&&t.responseText){var i=t.responseText.split("|");i.length&&(e.ui.labelValueHid.value(i[0]),e.ui.utcDateNowHid.value(i[1]))}e.initAddress()},onerror:function(){e.initAddress()},onabort:function(){e.initAddress()}})}},d});